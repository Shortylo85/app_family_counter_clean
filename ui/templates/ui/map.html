{% extends "../base.html" %}

{% block style %}
  <style media="screen">
    /* Always set the map height explicitly to define the size of the div
     * element that contains the map. */
    #map {
      height: 85%;
      position: relative;
      z-index: 1;
    }
    /* Optional: Makes the sample page fill the window. */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    #search_term {
      z-index: 1;
    }

  </style>
{% endblock %}


{% block jquery_autosearch%}
      <link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css" media="all" />
      <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>

{% endblock %}

{% block uiKit %} {% endblock %}

{% block nav %} {% endblock %}

{% block content %}
<br>
<br>
<br>

<form class="" action= {% url 'saveLocation'%} method="post">
  {% csrf_token %}
  <div class="uk-margin" uk-margin>
          <div uk-form-custom="target: true">
              <input class="uk-search-input" id="search_term" name="search_term" type="search" placeholder="Search...">
          </div>
          <button type="submit" class="uk-button uk-button-primary">Submit</button>
  </div>
</form>
<!-- {% for item in user_city_all %}
  {{item.user.username}} {{item.city.city_name}} {{item.city.lng}} {{item.city.lat}}<br>
{% endfor %}

{{user_city_all}} -->
{{ u_s.city.lng }} {{ u_s.city.lat }} {{ json_list }}

<!-- var j = {{json_list|safe}} -->

<div id="map"></div>


  <!-- <script>
  var p = {{json_list|safe}}
  console.log(p)
    function initMap() {

      var pyrmont = { lat: -28.024 , lng: 140.887 };
      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 8,
        center: pyrmont
      });



        var marker = new google.maps.Marker({
          position: pyrmont,
          map: map
        });


    }
  </script>

<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDIayL1Ao1hTSk7Y55ewEePkNyiE4F5-fg&callback=initMap">
</script> -->


<script>

  function initMap() {

    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 3,
      center: {lat: -28.024, lng: 140.887}
    });

    // Create an array of alphabetical characters used to label the markers.
    var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

    // Add some markers to the map.
    // Note: The code uses the JavaScript Array.prototype.map() method to
    // create an array of markers based on a given "locations" array.
    // The map() method here has nothing to do with the Google Maps API.
    var markers = locations.map(function(location, i) {
      return new google.maps.Marker({
        position: location,
        label: labels[i % labels.length]
      });
    });

    // Add a marker clusterer to manage the markers.
    var markerCluster = new MarkerClusterer(map, markers,
        {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
  }
locations = {{json_list|safe}}

  // locations = [
  //   {lat: -33.718234, lng: 150.363181},
  //   {lat: -33.727111, lng: 150.371124},
  //   {lat: -33.848588, lng: 151.209834},
  //   {lat: -33.851702, lng: 151.216968},
  //   {lat: -34.671264, lng: 150.863657},
  //   {lat: -35.304724, lng: 148.662905},
  //   {lat: -36.817685, lng: 175.699196},
  //   {lat: -36.828611, lng: 175.790222},
  //   {lat: -37.750000, lng: 145.116667},
  //   {lat: -37.759859, lng: 145.128708},
  //   {lat: -37.765015, lng: 145.133858},
  //   {lat: -37.770104, lng: 145.143299},
  //   {lat: -37.773700, lng: 145.145187},
  //   {lat: -37.774785, lng: 145.137978},
  //   {lat: -37.819616, lng: 144.968119},
  //   {lat: -38.330766, lng: 144.695692},
  //   {lat: -39.927193, lng: 175.053218},
  //   {lat: -41.330162, lng: 174.865694},
  //   {lat: -42.734358, lng: 147.439506},
  //   {lat: -42.734358, lng: 147.501315},
  //   {lat: -42.735258, lng: 147.438000},
  //   {lat: -43.999792, lng: 170.463352}
  //
  // ]
  console.log(locations);
  // var j = {{json_list|safe}}
  // console.log(j[0]['lat'])
  // for(var i=0; i<j.length; i++){
  //   console.log(j[i])
  // }

</script>
<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
</script>
<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwDRf9aXZnYGfEyUiAzoTk1sKw8gYKeEY&callback=initMap">
</script>

<script type="text/javascript">
  $(function() {
    // var source = [ "c++", "java", "php", "coldfusion", "javascript", "asp", "ruby" ];
    $("#search_term").autocomplete({
      source: "/map/get-term/",
      // source: source,
      minLength: 2,
    });
  });
</script>









{% endblock %}
